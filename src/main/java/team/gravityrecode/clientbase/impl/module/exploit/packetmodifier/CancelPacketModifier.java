package team.gravityrecode.clientbase.impl.module.exploit.packetmodifier;

import com.google.common.collect.Lists;
import net.minecraft.network.play.client.*;
import team.gravityrecode.clientbase.api.eventBus.EventHandler;
import team.gravityrecode.clientbase.api.moduleBase.Module;
import team.gravityrecode.clientbase.impl.event.networking.PacketEvent;
import team.gravityrecode.clientbase.impl.module.exploit.PacketModifier;
import team.gravityrecode.clientbase.impl.property.MultiBoolean;
import team.gravityrecode.clientbase.impl.property.MultipleBoolSetting;
import team.gravityrecode.clientbase.impl.property.mode.Mode;

import java.util.ArrayList;

public class CancelPacketModifier extends Mode {

    PacketModifier packetModifier = this.getOwner();
    private final MultipleBoolSetting packetsToCancel = new MultipleBoolSetting(this.getOwner(), "Cancelled Packets", cancelledPackets());

    public CancelPacketModifier(Module owner, String name) {
        super(owner, name);
        packetsToCancel.setVisible(() -> packetModifier.mode.getValue() == this);
    }

    @EventHandler
    public void test(PacketEvent event){
        if(event.getPacket() != null && canCancelPacket(event))
            event.setCancelled(true);
    }

    //this will be aids
    public boolean canCancelPacket(PacketEvent event){
        if(packetsToCancel.isSelected("C00") && event.getPacket() instanceof C00PacketKeepAlive)
            return true;

        if(packetsToCancel.isSelected("C0F") && event.getPacket() instanceof C0FPacketConfirmTransaction)
            return true;

        if(packetsToCancel.isSelected("C03") && event.getPacket() instanceof C03PacketPlayer)
            return true;

        if(packetsToCancel.isSelected("C04") && event.getPacket() instanceof C03PacketPlayer.C04PacketPlayerPosition)
            return true;

        if(packetsToCancel.isSelected("C05") && event.getPacket() instanceof C03PacketPlayer.C05PacketPlayerLook)
            return true;

        if(packetsToCancel.isSelected("C06") && event.getPacket() instanceof C03PacketPlayer.C06PacketPlayerPosLook)
            return true;

        if(packetsToCancel.isSelected("C0B") && event.getPacket() instanceof C0BPacketEntityAction)
            return true;

        if(packetsToCancel.isSelected("C0C") && event.getPacket() instanceof C0CPacketInput)
            return true;

        if(packetsToCancel.isSelected("C0A") && event.getPacket() instanceof C0APacketAnimation)
            return true;

        if(packetsToCancel.isSelected("C02") && event.getPacket() instanceof C02PacketUseEntity)
            return true;

        if(packetsToCancel.isSelected("C13") && event.getPacket() instanceof C13PacketPlayerAbilities)
            return true;

        if(packetsToCancel.isSelected("C17") && event.getPacket() instanceof C17PacketCustomPayload)
            return true;

        return packetsToCancel.isSelected("C19") && event.getPacket() instanceof C19PacketResourcePackStatus;
    }

    private ArrayList<MultiBoolean> cancelledPackets(){
        return Lists.newArrayList(
                new MultiBoolean(this.getOwner(), "C00", false),
                new MultiBoolean(this.getOwner(), "C0F", false),
                new MultiBoolean(this.getOwner(), "C03", false),
                new MultiBoolean(this.getOwner(), "C04", false),
                new MultiBoolean(this.getOwner(), "C05", false),
                new MultiBoolean(this.getOwner(), "C06", false),
                new MultiBoolean(this.getOwner(), "C0B", false),
                new MultiBoolean(this.getOwner(), "C0C", false),
                new MultiBoolean(this.getOwner(), "C0A", false),
                new MultiBoolean(this.getOwner(), "C02", false),
                new MultiBoolean(this.getOwner(), "C13", false),
                new MultiBoolean(this.getOwner(), "C17", false),
                new MultiBoolean(this.getOwner(), "C19", false)
        );
    }
}
